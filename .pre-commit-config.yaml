repos:
  
  # Ruff
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.5.7
    hooks:
      - id: ruff
        args: [--fix]
      - id: ruff-format

  # No Emoji
  - repo: local
    hooks:
      - id: no-emoji
        name: No Emoji
        entry: python
        language: system
        types: [text]
        args:
          - "-c"
          - |
            import subprocess, sys, re

            pattern = r"[\U0001F600-\U0001F64F\U0001F300-\U0001F5FF\U0001F680-\U0001F6FF\u2600-\u26FF]"
            out = subprocess.run(
                ["git", "grep", "-nP", pattern],
                capture_output=True,
                text=True
            )

            if out.returncode == 0 and out.stdout.strip():
                print("Emoji detected in the following locations:")
                # Parse each match: "<file>:<line>:<text>"
                for line in out.stdout.strip().splitlines():
                    parts = line.split(":", 2)
                    if len(parts) >= 2:
                        file, lineno = parts[0], parts[1]
                        print(f"  - {file}:{lineno}")
                sys.exit(1)

            sys.exit(0)

  # pytest
  - repo: local
    hooks:
      - id: pytest
        name: Pytest
        entry: pytest
        language: system
        types: [python]
        args: [tests]
        stages: [pre-push]
        always_run: true
